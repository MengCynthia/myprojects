<!DOCTYPE html>
<html ng-app="myApp"  lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    

    <title>HW8</title>

    <!-- Bootstrap core CSS -->
    <link href="./dist/css/bootstrap.min.css" rel="stylesheet">


    <link href="grid.css" rel="stylesheet">

    <style type="text/css">
      body {background-image: url(http://cs-server.usc.edu:45678/hw/hw8/images/background.png);background-size:cover;background-repeat: repeat;}
      table {
            background-color: white;
      }
      h4 {
        text-align: center;
      }
      @keyframes slideInRight {
  from   { transform:translateX(100%); }
  to     { transform: translateX(0); }
}
@keyframes slideOutLeft {
  to     { transform: translateX(-100%); }
}
      .slide {
    
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
}
.slide.ng-enter,
.slide.ng-leave {
    -webkit-transition: all 1s ease;
    transition: all 1s ease;
}
.slide.ng-enter {
    animation: slideInRight 0.5s both ease-in; z-index: 8888;
}
.slide.ng-enter-active {
    left: 0;
}
.slide.ng-leave {
    animation: slideOutLeft 0.5s both ease-in; z-index: 9999;
}
.slide.ng-leave-active {
    left: -100%;
}
    </style>
    <style>
  .full button span {
    background-color: limegreen;
    border-radius: 32px;
    color: black;
  }
  .partially button span {
    background-color: orange;
    border-radius: 32px;
    color: black;
  }
</style>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.11/angular.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.11/angular-animate.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.11/angular-aria.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular-sanitize.js"></script>
    <script src="https://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-2.5.0.js"></script>

    <link href="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  
    <script src="https://code.highcharts.com/stock/highstock.src.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
   <script src="highcharts-ng.js"></script>
   <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
   <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">


  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.4/angular-material.min.js"></script>

   

  </head>

  <body>



   <script>

    function ajaxClass(_http,_url,_method,_params,_headers,_data,_responseType,_successCallback,_failureCallback){
    this.http = _http
    this.url = _url || "";
    this.method = _method || "GET";
    this.params = _params || "";
    this.headers = _headers || "";
    this.data = _data || "";
    this.responseType = _responseType || "json";
    this.successCallback = _successCallback || function(res){
    };
    this.failureCallback = _failureCallback || function(res){
    
    };
    this.requestData = function (){
        this.http({
        method:this.method,
        url:this.url,
        params:this.params,
        data:this.data,
        headers : this.headers,
        responseType : this.responseType
    }).then(this.successCallback, this.failureCallback).catch(angular.noop);
    }
}


var myApp = angular.module('myApp',['highcharts-ng','ui.bootstrap','ngMaterial','ngMessages']);

myApp.controller('myCtrl',function($scope,$http,$interval,$timeout){
    localdata = "";
    var url = "/123/";
    $scope.myslide=0
    $scope.chartConfig =new Object();
    $scope.char1=0;
    $scope.favlist = new Array();
    $scope.charsymbol = new Object();
    $scope.charsymbol['Price']=0;
       $scope.charsymbol['SMA']=0;
       $scope.charsymbol['EMA']=0;
       $scope.charsymbol['RSI']=0;
       $scope.charsymbol['CCI']=0;
       $scope.charsymbol['STOCH']=0;
       $scope.charsymbol['BBANDS']=0;
       $scope.charsymbol['ADX']=0;
       $scope.charsymbol['MACD']=0;
    //$scope.favlist =[];
    //localStorage.clear();
    for(var i=0; i<localStorage.length; i++){
      var key = localStorage.key(i);
      $scope.favlist[i]=JSON.parse(localStorage.getItem(key));
    }
    console.log($scope.favlist);
    $scope.model = {
    name: 'Tabs'
    };
    $scope.choose=1;
    $scope.pill1="active";
    $scope.$watch('choose',function(){
      if($scope.choose==1){
        $scope.pill1="active";
        $scope.pill2="";
        $scope.pill3="";
      }
      else if($scope.choose==2){
        $scope.pill2="active";
        $scope.pill1="";
        $scope.pill3="";
      }
      else if($scope.choose==3){
        $scope.pill3="active";
        $scope.pill2="";
        $scope.pill1="";
      };

    });
  

$scope.empty = function(){
   if($scope.searchText.length==0){
      $scope.searchText=null;
   }
}


$scope.autocomplete = function(symtext){
  console.log("auto");
       return $http({
        method:"get",
        url:'/789/',
        params:{'symbol':symtext}
    }).then(function(res) {
        return res.data;
      });
  }

  function changeformat(n){
　　    var p=/\d{1,3}(?=(\d{3})+$)/g;
　　    var q=n.replace(/^(\d+)((\.\d+)?)$/,function(s,s1,s2){return s1.replace(p,"$&,")+s2;});
　　    return q;
      }

  $scope.removefav = function(favsymbol){
    console.log("favsymbol:"+favsymbol);
    localStorage.removeItem(favsymbol);
    $scope.favlist=[];
    console.log(1+$scope.favlist);
    for(var i=0; i<localStorage.length; i++){
      var key = localStorage.key(i);
      $scope.favlist[i]=JSON.parse(localStorage.getItem(key));
    }
    console.log(2+$scope.favlist);
  }


  $scope.autorefresh = function(){
    $interval(refreshfav(),1000,10);
  }

  $scope.refreshfav = function(a){
    //localStorage.clear();
    var favlist_ = new Array();
    favlist_ = [];
    var num = 0;
    for(var i=0; i<localStorage.length; i++){
      var key = localStorage.key(i);
      favlist_[i]=JSON.parse(localStorage.getItem(key));
    }
    //console.log("fav:"+JSON.stringify(favlist_));
    for(var i=0; i<favlist_.length;i++){
      var symbollist = favlist_[i].Symbol;
      var url = "/456/";
      var ajax1 = new ajaxClass($http,url,"get");
     //console.log(symbollist);
      ajax1.params = {"symbol":symbollist};                    // 表单方式传递数据或者可以使用在url后面加？limit=11这样的形式传递
    // get方式请求数据不需要设置表头header
      ajax1.successCallback = function(res){
        var status = res.data.status;
       var refreshdata = res.data;
      console.log(refreshdata);
      var reA = new Array();
      rea = new Array();
      reA =  Object.keys(refreshdata["Time Series (1min)"]);
      if(reA.length<10){
        for(var i = 0; i<reA.length; i++){
          rea[i]=reA[i];
        }
      }
      else{
        for(var i = 0; i<2; i++){
         rea[i]=reA[i];
        }
      }

      var reSymbol = refreshdata["Meta Data"]["2. Symbol"];
      var reClose = parseFloat(refreshdata["Time Series (1min)"][rea[0]]["4. close"]).toFixed(2);
      var reOpen = parseFloat(refreshdata["Time Series (1min)"][rea[0]]["1. open"]).toFixed(2);
      var rePreClose = parseFloat(refreshdata["Time Series (1min)"][rea[1]]["4. close"]).toFixed(2);
      var reChange = (refreshdata["Time Series (1min)"][rea[0]]["4. close"] - refreshdata["Time Series (1min)"][rea[1]]["4. close"]).toFixed(2);
      var reChaPrecent = (((refreshdata["Time Series (1min)"][rea[0]]["4. close"] - refreshdata["Time Series (1min)"][rea[1]]["4. close"]) / refreshdata["Time Series (1min)"][rea[1]]["4. close"])*100).toFixed(2)+"%";
      
    //  console.log("change:"+reChange+reChaPrecent);
      var VolumeLast = refreshdata["Time Series (1min)"][rea[0]]["5. volume"];
      var rechanVo=changeformat(VolumeLast);
    //  console.log("volume:"+rechanVo);
      var reArrow ="";
      var rechangecolor="";
      if (reChange >0){
        reArrow+='http://cs-server.usc.edu:45678/hw/hw6/images/Green_Arrow_Up.png';
        rechangecolor+="green";
      }
      else if(reChange<0){
      reArrow+='http://cs-server.usc.edu:45678/hw/hw6/images/Red_Arrow_Down.png';
      rechangecolor+="red";
      }
    //  console.log("rechangecolor:"+rechangecolor);
      refavlistcon = new Object();
      refavlistcon['Symbol']=reSymbol;
      refavlistcon['Stockprice']=reClose;
      refavlistcon['Change']=reChange;
      refavlistcon['Change_p']=reChaPrecent;
      refavlistcon['Arrow']=reArrow;
      refavlistcon['changecolor']=rechangecolor;
      if(a==1){
        refavlistcon['Volume']=(JSON.parse(localStorage.getItem(reSymbol))).Volume;
      }
      else{
        refavlistcon['Volume']=rechanVo;
      }
      
    //  console.log(refavlistcon);
        localStorage.setItem(reSymbol,JSON.stringify(refavlistcon));
        num++;
        console.log("num:"+num);
        if(num==favlist_.length){
          $scope.favlist=[];
          for(var i=0; i<localStorage.length; i++){
             var key = localStorage.key(i);
             $scope.favlist[i]=JSON.parse(localStorage.getItem(key));
          }
          console.log(JSON.parse(JSON.stringify($scope.favlist)));
        }
      }
      ajax1.failureCallback = function(res){
    };
    ajax1.requestData();
    
    }
       
  }

  $scope.switch = false;
  $scope.autorefreshon = function(a){
        $scope.timer =  $interval(function(a) {
                           $scope.refreshfav(a);
                        }, 5000);
      }
  $scope.autorefreshoff = function(){
        $interval.cancel($scope.timer);
      }

$scope.check = function(a){
  console.log($scope.switch);
   
   $scope.switch = !$scope.switch;
   if($scope.switch){
    console.log("kai");
      
      $scope.autorefreshon(a);
    }
    else{
      console.log("guan");
      
     $scope.autorefreshoff();
    }
}

   $scope.fbshare = function(){
    console.log("fb");
        FB.ui({
            app_id: YOUR_APP_ID,
            method: 'feed',
            picture: urlOR_PICTURE
            }, (response) => {
            if (response && !response.error_message) {
                      //succeed 
                      console.log(response);
             }
             else{
                    console.log("fbfail!");      //fail 
             }
        });
    
    }


  $scope.starshow = function(){
      
      if(localStorage.getItem($scope.symbol)==null){
          localStorage.setItem($scope.symbol,JSON.stringify($scope.favlistcon));
        $scope.star="glyphicon glyphicon-star";
        $scope.starcolor = "yellow";
        $scope.favlist=[];
        console.log(5+$scope.favlist);
        for(var i=0; i<localStorage.length; i++){
          var key = localStorage.key(i);
          $scope.favlist[i]=JSON.parse(localStorage.getItem(key));
        }
        console.log(6+$scope.favlist);
      }
      else {
        localStorage.removeItem($scope.symbol);
        $scope.star="glyphicon glyphicon-star-empty";
        $scope.starcolor = "";
        $scope.favlist=[];
        console.log(7+$scope.favlist);
        for(var i=0; i<localStorage.length; i++){
          var key = localStorage.key(i);
          $scope.favlist[i]=JSON.parse(localStorage.getItem(key));
        }
        console.log(8+$scope.favlist);
      }
    }
    //var url = "a.php?limit=10"
    $scope.processForm = function(symbol1){
      $scope.symbol=symbol1;
      console.log("char12:"+$scope.char1);
      console.log($scope.symbol);
       $scope.char1=0;


      /* $scope.charsymbol['Price']=0;
       $scope.charsymbol['SMA']=0;
       $scope.charsymbol['EMA']=0;
       $scope.charsymbol['RSI']=0;
       $scope.charsymbol['CCI']=0;
       $scope.charsymbol['STOCH']=0;
       $scope.charsymbol['BBANDS']=0;
       $scope.charsymbol['ADX']=0;
       $scope.charsymbol['MACD']=0;*/
       $scope.pricesecceed = 1;
       $scope.SMAsecceed = 1;
       $scope.EMAsecceed = 1;
       $scope.STOCHsecceed = 1;
       $scope.CCIsecceed = 1;
       $scope.ADXsecceed = 1;
       $scope.BBANDSsecceed = 1;
       $scope.MACDsecceed = 1;
       $scope.interdaysecceed = 1;
       $scope.newsecceed = 1;

       if(localStorage.getItem($scope.symbol)!=null){
        $scope.star="glyphicon glyphicon-star";
        $scope.starcolor = "yellow";
       }
        else{
          $scope.star="glyphicon glyphicon-star-empty";
          $scope.starcolor = "";
        }

      var ajax = new ajaxClass($http,url,"get");
      ajax.params = {"symbol":$scope.symbol};                    // 表单方式传递数据或者可以使用在url后面加？limit=11这样的形式传递
    // get方式请求数据不需要设置表头header
      ajax.successCallback = function(res){
        var status = res.data.status;

        $scope.data = res.data;
        
        //localdata = JSON.parse(localStorage.getItem("stock"));
        localdata = $scope.data;
        
        console.log(localdata);
        if(localdata.hasOwnProperty('price')){
          if(localdata['price'].length!==0){
            $scope.pricesecceed = 1;
          }else
          {
             $scope.pricesecceed = 0;
          }
             
        }
        else{
           $scope.pricesecceed = 0;
        }
        if(localdata.hasOwnProperty('INTRADAY')){
             if(localdata['INTRADAY'].length!==0){
            $scope.interdaysecceed = 1;
          }else
          {
             $scope.interdaysecceed = 0;
          }
        }
        else{
           $scope.interdaysecceed = 0;
        }
        if(localdata.hasOwnProperty('SMA')){
             if(localdata['SMA'].length!==0){
            $scope.SMAsecceed = 1;
          }else
          {
             $scope.SMAsecceed = 0;
          }
        }
        else{
           $scope.SMAsecceed = 0;
        }
        if(localdata.hasOwnProperty('EMA')){
             if(localdata['EMA'].length!==0){
            $scope.EMAsecceed = 1;
          }else
          {
             $scope.EMAsecceed = 0;
          }
        }
        else{
           $scope.EMAsecceed = 0;
        }
        if(localdata.hasOwnProperty('STOCH')){
            if(localdata['STOCH'].length!==0){
            $scope.STOCHsecceed = 1;
          }else
          {
             $scope.STOCHsecceed = 0;
          }
        }
        else{
           $scope.STOCHsecceed = 0;
        }
        if(localdata.hasOwnProperty('RSI')){
             if(localdata['RSI'].length!==0){
            $scope.RSIsecceed = 1;
          }else
          {
             $scope.RSIsecceed = 0;
          }
        }
        else{
           $scope.RSIsecceed = 0;
        }
        if(localdata.hasOwnProperty('ADX')){
            if(localdata['ADX'].length!==0){
            $scope.ADXsecceed = 1;
          }else
          {
             $scope.ADXsecceed = 0;
          }
        }
        else{
           $scope.ADXsecceed = 0;
        }
        if(localdata.hasOwnProperty('CCI')){
            if(localdata['CCI'].length!==0){
            $scope.CCIsecceed = 1;
          }else
          {
             $scope.CCIsecceed = 0;
          }
        }
        else{
           $scope.CCIsecceed = 0;
        }
        if(localdata.hasOwnProperty('BBANDS')){
             if(localdata['BBANDS'].length!==0){
            $scope.BBANDSsecceed = 1;
          }else
          {
             $scope.BBANDSsecceed = 0;
          }
        }
        else{
           $scope.BBANDSsecceed = 0;
        }
        if(localdata.hasOwnProperty('MACD')){
             if(localdata['MACD'].length!==0){
            $scope.MACDsecceed = 1;
          }else
          {
             $scope.MACDsecceed = 0;
          }
        }
        else{
           $scope.MACDsecceed = 0;
        }

        $scope.articlenews = new Array();
        function article(){
         
          if(localdata['news']['rss']['channel'][0]['item']){
             
             var news = localdata['news']['rss']['channel'][0]['item'];
          console.log(news);
          var articleurl = /^https:\/\/seekingalpha\.com\/article\//;
          var re = new RegExp(articleurl);
          var urlcount = 0;
          console.log(123445);
           for(var i=0; i<news.length && urlcount<5; i++){
             if(re.test(news[i]['link'])){
              var artnews = new Object();
               artnews['title']=news[i]['title'][0];
               artnews['link']=news[i]['link'][0];
               artnews['author']=news[i]['sa:author_name'][0];
               artnews['pubDate']=news[i]['pubDate'][0].replace(/-0500/, "EST");
               $scope.articlenews[urlcount]=artnews;
               urlcount++;
             }
           }
           if (urlcount==0) {
            $scope.newsecceed = 0;
           }
           else{
            $scope.newsecceed = 1;
           }
        }
        else{
           $scope.EMAsecceed = 0;
        }
        }
        article();
        console.log($scope.articlenews);
        //sym = $scope.symbol;

        console.log(localdata);
        
        //console.log(localStorage);
       console.log("status = " + status);
        

 
  //console.log("pricesecceed"+pricesecceed+"interdaysecceed"+interdaysecceed);
      var A = new Array();
      $scope.a = new Array();
      var b = new Array();
      A =  Object.keys(localdata['price']["Time Series (Daily)"]);
      if(A.length<130){
        for(var i = 0; i<A.length; i++){
          $scope.a[i]=A[i];
        }
      }
      else{
        for(var i = 0; i<130; i++){
         $scope.a[i]=A[i];
        }
      }
      if(A.length<1000){
        for(var i = 0; i<A.length; i++){
          b[i]=A[i];
        }
      }
      else{
        for(var i = 0; i<1000; i++){
         b[i]=A[i];
        }
      }
      console.log("a:"+$scope.a);
      

Interday = localdata['INTRADAY'];
      var interA = new Array();
      var intera = new Array();
      interA =  Object.keys(Interday["Time Series (1min)"]);
      if(interA.length<10){
        for(var i = 0; i<interA.length; i++){
          intera[i]=interA[i];
        }
      }
      else{
        for(var i = 0; i<10; i++){
         intera[i]=interA[i];
        }
      }

      
      
      Price = localdata['price'];
      $scope.Symbol_ = Price["Meta Data"]["2. Symbol"];
      $scope.Close = parseFloat(Interday["Time Series (1min)"][intera[0]]["4. close"]).toFixed(2);
      $scope.Open = parseFloat(Price["Time Series (Daily)"][$scope.a[0]]["1. open"]).toFixed(2);
      //$scope.PreClose = parseFloat(Price["Time Series (Daily)"][$scope.a[1]]["4. close"]).toFixed(2);
      $scope.Change = (Price["Time Series (Daily)"][$scope.a[0]]["4. close"] - Price["Time Series (Daily)"][$scope.a[1]]["4. close"]).toFixed(2);
      $scope.ChaPrecent = (((Price["Time Series (Daily)"][$scope.a[0]]["4. close"] - Price["Time Series (Daily)"][$scope.a[1]]["4. close"]) / Price["Time Series (Daily)"][$scope.a[1]]["4. close"])*100).toFixed(2)+"%";
      $scope.DayRange = parseFloat(Price["Time Series (Daily)"][$scope.a[0]]["3. low"]).toFixed(2)+"-"+
                  parseFloat(Price["Time Series (Daily)"][$scope.a[0]]["2. high"]).toFixed(2);
      VolumeLast = Price["Time Series (Daily)"][$scope.a[0]]["5. volume"];
      $scope.chanVo=changeformat(VolumeLast);
      $scope.Timestamp = intera[0]+"  EST";
      $scope.Timestamptody = $scope.a[0];
      

      var daytimetest = /16:00:00/;
      var retest = new RegExp(daytimetest);
      if(retest.test($scope.Timestamp)){
         $scope.PreClose = $scope.Close;
      }
       else{
        $scope.PreClose = parseFloat(Price["Time Series (Daily)"][$scope.a[1]]["4. close"]).toFixed(2);
      }

      $scope.DateCount = $scope.a.length;
      $scope.Arrow ="";
      if ($scope.Change >0){
        $scope.Arrow+='http://cs-server.usc.edu:45678/hw/hw6/images/Green_Arrow_Up.png';
        $scope.changecolor="green";
      }
      else if($scope.Change<0){
      $scope.Arrow+='http://cs-server.usc.edu:45678/hw/hw6/images/Red_Arrow_Down.png';
      $scope.changecolor="red";
      }
      $scope.Price_ = new Array();
      $scope.Pricestock = new Array();
      $scope.Volume_ = new Array();
      $scope.favlistcon = new Object();
      $scope.favlistcon['Symbol']=$scope.symbol;
      $scope.favlistcon['Stockprice']=$scope.Close;
      $scope.favlistcon['Change']=$scope.Change;
      $scope.favlistcon['Change_p']=$scope.ChaPrecent;
      $scope.favlistcon['Arrow']=$scope.Arrow;
      $scope.favlistcon['changecolor']=$scope.changecolor;
      $scope.favlistcon['Volume']=$scope.chanVo;

      console.log($scope.favlistcon);
      for (var i=0; i<$scope.DateCount; i++) {
        $scope.Price_[i]=parseFloat(Price["Time Series (Daily)"][$scope.a[i]]["4. close"]).toFixed(2);
        $scope.Volume_[i]=Price["Time Series (Daily)"][$scope.a[i]]["5. volume"];
      }


      for (var i=0; i<b.length; i++) {
        $scope.Pricestock[b.length-i-1]=new Array();
        $scope.Pricestock[b.length-i-1][0]=Date.parse(b[i]);
        $scope.Pricestock[b.length-i-1][1]= parseFloat(Price["Time Series (Daily)"][b[i]]["4. close"]);
      }
      //$scope.Pricestock = $scope.Pricestock.map(function(el){return parseFloat(el);});
      console.log($scope.Pricestock);


        
      //}

    $scope.stockConfig={
       chartType: 'stock',
       chart: {
         
           width: 1000
        },
        rangeSelector: {
            buttons: [{
              type: 'week',
              count: 1,
              text: '1w'
            },
            {
             type: 'month',
             count: 1,
             text: '1m'
            }, {
             type: 'month',
             count: 3,
             text: '3m'
            }, {
             type: 'month',
             count: 6,
             text: '6m'
            }, {
             type: 'ytd',
             text: 'YTD'
            }, {
             type: 'year',
             count: 1,
             text: '1y'
            }, {
             type: 'all',
             text: 'All'
            }],
            selected: 0
        },

        title: {
            text: $scope.Symbol_+' Stock Price'
        },


        series: [{
            name: $scope.Symbol_,
            type: 'area',
            data: $scope.Pricestock,
            tooltip: {
                shared: true,
                valueDecimals: 2
            }
        }]
    }
  

   
      
   function changeDateFormat(inputDate){  // expects Y-m-d
        var outputDate = new Array();
       for (var i = 0; i < inputDate.length; i++) {
        var tests=/:/;
        var retests = new RegExp(tests);
        var splitDate1 ="";
        if(retests.test(inputDate[i])){
       var splitDate1 = inputDate[i].split(' ',1);
       //console.log(inputDate[i]+" "+splitDate1);
        }else{
          splitDate1 = inputDate[i];
     }
     //console.log("splitDate1"+splitDate1);
       var splitDate = splitDate1.toString().split('-');

       if(splitDate.count == 0){
         return null;
        }

        var year = splitDate[0];
        var month = splitDate[1];
        var day = splitDate[2]; 
        outputDate[i] = month + '\/' + day;

        }
        //console.log(outputDate);
         return outputDate;

        }

   function changeTSFormat(inputDate){  // expects Y-m-d 
       var splitDate = inputDate.split('-');
       if(splitDate.count == 0){
         return null;
        }

         var year = splitDate[0];
         var month = splitDate[1];
         var day = splitDate[2]; 
          return month + '\/' + day + '\/' + year;

         }

  
showChar = function(indicator){
  console.log("indicator:"+indicator);
  $scope.char1 = 1;
  var jsonObj = localdata[indicator];
  //console.log(jsonObj);
 // var dateCount = '<?php echo $DateCount ?>';
 // var symbol = '<?php echo $Symbol ?>';
  if (indicator == "Price"){
     //var date =  eval('<?php echo json_encode($a); ?>');
     //var toDay = '<?php echo $Timestamp ?>';

     toDay_ = changeTSFormat($scope.Timestamptody);
     //console.log(date);
     
     var date_ = changeDateFormat($scope.a);
     console.log(11);
     //console.log(date_);
     //console.log(toDay_);
     //var Price =  eval('<?php echo json_encode($Price); ?>');
     $scope.Price_ = $scope.Price_.map(function(el){return parseFloat(el);});
     console.log($scope.Price_);
     //var Volume =  eval('<?php echo json_encode($Volume); ?>');
     $scope.Volume_ = $scope.Volume_.map(function(el){return parseFloat(el);});
     var maxVo = Math.max.apply(null,$scope.Volume_);
     console.log(12);
     //console.log(Volume);
     $scope.chartConfig[indicator] = {
        chart: {
          zoomType: 'xy',
           width: 500,
          height: (3 / 4 * 100) + '%'
        },
        title: {
        text: 'Stock Price'+' '+ '('+ toDay_ + ')'
        },
        subtitle: {
          useHTML:true,
          text: 'Source: <a href="https://www.alphavantage.co/" target="_blank"> Alpha Vantage </a>',

          style: {
            color: "#2e62e6"
          }
        },
        xAxis: [{
          categories: date_,
          showLastLabel: true,
          //crosshair: true,
          tickInterval: 5,
          reversed: true
        }],
        yAxis: [{ // Primary yAxis
       // min:135,
          tickAmount:4,
        //tickInterval: 5,
          labels: {
            format: '{value}',
          
            style: {
                color: Highcharts.getOptions().colors[1]
            }
          },
          title: {
            text: 'Stock Price',
            style: {
                color: Highcharts.getOptions().colors[1]
            }
          }
        },
        
        { // Secondary yAxis
        //tickInterval: 50000000,
        //max:maxVo*4,
        tickAmount: 4,
        title: {
            text: 'Volume',
            style: {
                color: Highcharts.getOptions().colors[1]
            }
        },
        labels: {
            //format: '{value}M',
            formatter: function () {
                return this.value / 1000000 + 'M';
            },
            style: {
                color: Highcharts.getOptions().colors[1]
            }
        
        },
        opposite: true
        }],
        tooltip: {

        //shared: true
        },
        legend: {
           
          //layout: 'vertical',
          align: 'center',
          //verticalAlign: 'middle',

          backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'
        },
        tooltip: {
            pointFormat:'<span style="color:{point.color}">\u25CF</span>'+'{series.name}'+':<b>{point.y:,..2f}<b><br />'
        },   
        series: [{
          id: $scope.symbol,
          name: $scope.symbol,
          type: 'area',
          //threshold: null,
          data: $scope.Price_,

          //lineColor: "#f80000",
        
          
          color:"#1325f4",
          fillOpacity: 0.3,
          lineWidth:1,
        
        },
     

        {
          id: $scope.symbol+' Volume',
          name: $scope.symbol+' Volume',
          type: 'column',
          color: "#f80000",
          yAxis: 1,
          data: $scope.Volume_,
          tooltip: {
            valueSuffix: '',
            pointFormat:'<span style="color:{point.color}">\u25CF</span>'+'{series.name}'+':<b>{point.y}<b><br />'
          }

        }]
      };//endchartconfig
    console.log(12);
    
  }
  else {
    
    var Title = jsonObj["Meta Data"]["2: Indicator"];
    console.log("title:"+Title);
    
    var data2 = new Array();
    var one;
    for (one in jsonObj) {
      //console.log(one);
      if(one != "Meta Data"){
       // console.log(one);
       if(jsonObj[one]!=""){
        
        var keys = new Array();
        for(var d in jsonObj[one]){
          keys.push(d);
        }
      }
        
      }
    }
    var obkey = Object.keys(jsonObj[one]);
    //console.log(obkey);
    if(obkey.length==0){
      charsymbol[indicator]=1;
    }
    else{
    
        //console.log(keys);
        var data1 =new Array();
        //console.log(jsonObj[one][keys[0]]); 
        var title1 = new Array();
        for(var m in jsonObj[one][keys[0]]){
          title1.push(m);
        }
        var key1s = new Array();
        for(var p in jsonObj[one][keys[0]]){
          
            key1s.push(p);
          }
        //console.log(jsonObj[one][keys[0]].length);
        var date1 = new Array();
        for(var t = 0; t < title1.length; t++){
         data1[t] = new Array();
         for(var q = 0; q<$scope.DateCount-1; q++){ 
          date1.push(keys[q]);
          
          
            data1[t].push(parseFloat(jsonObj[one][keys[q]][key1s[t]]));
          
        }
        //console.log(data1[t]);
      }
        //console.log(data1);
        var date_1 = changeDateFormat(date1);
        var Series_a = new Array();
        if(title1.length==1){
          var Series_o = new Object();

          Series_o.id = $scope.Symbol_;
          Series_o.name = $scope.Symbol_;
          Series_o.data = data1[0];
          Series_a[0]=Series_o;
        }
        else{
        for(var t = 0; t < title1.length; t++){
          var Series_o = new Object();
          Series_o.id = $scope.Symbol_+" "+title1[t];
          Series_o.name = $scope.Symbol_+" "+title1[t];
          Series_o.data = data1[t];
          Series_a[t]=Series_o;

        }
      }

     
    console.log("indicator1:"+indicator);

    $scope.chartConfig[indicator] = {
    chart: {
      width: 500,
        height: (3 / 4 * 100) + '%' // 16:9 ratio
    },
    title: {
        text: Title
    },

    subtitle: {
      useHTML:true,
        text: 'Source: <a href="https://www.alphavantage.co/" target="_blank"> Alpha Vantage </a>',
        style: {
                color: "#2e62e6"
            }
    },

    xAxis: [{
        categories: date_1,
        //crosshair: true,
        tickInterval: 5,
        reversed: true
        
    }],
    yAxis: {
        title: {
            text: indicator
        },
        //min:135,
        //ttickAmount:8,
        labels: {
            format: '{value}',
        }
        
    },
    legend: {
        //layout: 'vertical',
        align: 'center',
       // verticalAlign: 'middle',
    },
    colors: ['#FF0000','#058DC7','#FF9655'],
    plotOptions: {
        series: {
            marker: {
                radius: 2
            },
            lineWidth: 1,
            //lineColor: "#f80000",

        }
    },
    series: Series_a,

    responsive: {
        rules: [{
            condition: {
                maxWidth: 500
            },
            chartOptions: {
                legend: {
                    layout: 'horizontal',
                    align: 'center',
                    verticalAlign: 'bottom'
                }
            }
        }]
    }
        

  };
    }}
  console.log("indicator2:"+indicator);
console.log(indicator);
//$scope.charsymbol[indicator]=1;
  }//endofshow


    console.log("char1:"+$scope.char1);

        showChar('Price');
        showChar('SMA'); 
        showChar('EMA'); 
        showChar('STOCH');
        showChar('ADX');
        showChar('CCI');
        showChar('RSI');
        showChar('BBANDS');
        showChar('MACD');
       // $scope.char1=1;

    };
    ajax.failureCallback = function(res){
    };
    ajax.requestData();

}
   
  
});
  
      
  
    </script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <div  ng-controller="myCtrl">
      <br />
      <br />
     <div class="panel panel-default container" style="margin-bottom: 0px">
      <div class="panel-body ">
       <div ng-model="data"></div>
         <h4>Stock Market Search</h4>
         

      <div  ng-cloak class="autocompletedemoBasicUsage row">
         

        <md-content class="col-md-12 col-xs-12" style="padding: 15 0 0 0">
          <div class="row" >
         <form  name="autocompleteForm" style="padding: 15 0 0 0" class="form-inline col-md-12" ng-submit="processForm(searchText)">
          <div class="row" style="padding: 0 0 0 0">
            <div class="col-md-3 col-xs-8" style="margin-top: 10px">
              <label for="inputsymbol" class="control-label">Enter Stock Ticker Symbol:</label>
            </div>
          <div class="col-md-9 col-xs-10">
          <span class="form-group" style="width: 65%">
            
           <md-autocomplete  ng-click="empty()" md-clear-button="false" required md-input-name="autocomplete" md-selected-item="selectedItem" md-search-text="searchText" md-items="item in autocomplete(searchText)" placeholder="e.g. AAPL" md-item-text="item.Symbol">
             <md-item-template>
               <span md-highlight-text="searchText">{{item.Symbol}} - {{item.Name}} ({{item.Exchange}})</span>
             </md-item-template>
             
             <md-not-found>
               No matches found.
             </md-not-found>
           
          </md-autocomplete>
          <div ng-show="searchText==null">Please enter a stock ticker symbol</div>

       </span>
          <span class="col-xs-10"></span>

          <span>
          <button type="submit" ng-disabled="searchText.length==0 || searchText==null" class="btn btn-primary" id="Quote"><span class="glyphicon glyphicon-search" aria-hidden="true" >
            
          </span>&nbspGet Quote</button>
          </span>
          <span>
          <button type="button" ng-click="searchText='';symbol=''" class="btn btn-default"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>&nbspClear</button>
          </span>
          </div>
        </div>
        </form>
        </div>
      </md-content>
</div>
       </div>
     </div>
<div class="container" style="padding: 0 0 0 0">
  <hr />
</div>
     

    <div id= "Favorite" ng-view ng-show="myslide==0" class="panel panel-default container slide">
      <div class="panel-heading row" >
          <div class="col-xs-5 col-md-4" style="padding: 0px 2px 0px 0px"> 
            <b>Favorite List</b>
          </div>
          <div class="hidden-xs col-md-4" ></div>
          <div class="col-xs-7 col-md-4" style="float: right; padding: 0px 0px 0px 0px"">
          <span class="hidden-xs">Automatic Refresh:</span>
          <span>
            <input type="checkbox"  class="form-control" ng-model="switch" data-toggle="toggle" 
                   onchange="angular.element(this).scope().check(2)">
            
          
              <button type="submit" ng-click="refreshfav(1)"  class="btn btn-default" >
               <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
              </button>
          
         
                <button type="button" ng-click="myslide=1" ng-disabled="symbol.length==0 ||symbol.length==null " class="btn btn-default">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true">
                </span>
              </button>
          
              
          </span>
          
        </div>
        
      </div>  

        <div class="row">
         <div class="col-md-1 col-xs-3"  ><b>Sort by</b></div>
         <div class="col-md-2 col-xs-10">
          <select ng-model="sort" ng-init="sort='$index'" class="form-control">
           <option value="$index">Default</option>
           <option value="Symbol">Symbol</option>
           <option value="Stockprice">Price</option>
           <option value="Change">Change</option>
           <option value="Change_p">Change Percent</option>
           <option value="Volume">Volume</option>
          </select>
         </div> 
         <div class="col-md-1 col-xs-3" ><b>Order</b></div>
         <div class="col-md-2 col-xs-10">
          <select ng-model="order" ng-init="order=''" class="form-control" ng-disabled="sort=='Default'">
           <option value="">Ascending</option>
           <option value="-">Descending</option>
          </select>
         </div>
        </div>
     
         <table class='table table-striped table-responsive' style="overflow-x:scroll">
           <tr><th>Symbol</th><th>Stock Price</th><th>Change(Change Percent)</th><th>Volume</th><th></th></tr>
           <tr ng-repeat="fav in favlist | orderBy:order+sort">
            <td><a href="" ng-click="processForm(fav.Symbol)">{{fav.Symbol}}</a></td>
            <td>{{fav.Stockprice}}</td>
            <td ng-style="{'color':fav.changecolor}">{{fav.Change}}&nbsp({{fav.Change_p}})<img ng-src={{fav.Arrow}} height='14'/></td><td>{{fav.Volume}}</td>
            <td><button type="button" ng-click="removefav(fav.Symbol)" class="btn btn-default"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button></td>
           </tr>

         </table>
     

</div>
     


      <div class="panel panel-default container slide" ng-view ng-show="myslide==1" id="detail">
       <div class="panel-heading row">
          <div class="col-md-2 col-xs-2" style="padding: 2px 2px 0 4px">
            
               <button type="button" ng-click="myslide=0" class="btn btn-default">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true">
                </span>
              </button>
         
            
            </div>
          <div class="col-md-8 col-xs-8" style="padding: 2px 2px 0 4px">
            <h3 class="panel-title" style="text-align: center;">Stock Details</h3>
          </div>
        
      </div> 

      <div class="row">
        <div class="col-md-6 hidden-xs" >
            <ul class="nav nav-pills">
            <li ng-class="pill1"><a href="" ng-click="choose=1"><span class="glyphicon glyphicon-dashboard" aria-hidden="true" ></span>&nbsp Current Stock</a></li>
            <li ng-class="pill2"><a href="" ng-click="choose=2"><span class="glyphicon glyphicon-stats" aria-hidden="true" ></span>&nbsp Historical Charts</a></li>
            <li ng-class="pill3"><a href="" ng-click="choose=3"><span class="glyphicon glyphicon-link" aria-hidden="true" ></span>&nbsp News Feeds</a></li>
          </ul>
        </div>
      <div class="visible-xs col-xs-12" >
            <ul class="nav nav-pills">
            <li ng-class="pill1"><a href="" ng-click="choose=1"><span class="glyphicon glyphicon-dashboard" aria-hidden="true" ></span>&nbsp Stock</a></li>
            <li ng-class="pill2"><a href="" ng-click="choose=2"><span class="glyphicon glyphicon-stats" aria-hidden="true" ></span>&nbsp Charts</a></li>
            <li ng-class="pill3"><a href="" ng-click="choose=3"><span class="glyphicon glyphicon-link" aria-hidden="true" ></span>&nbsp News</a></li>
          </ul>
        </div>
      </div>

        <hr>
      
    <div  class="tab-content">
        <div ng-show="choose==1" id="current_stock">
          <br>
          <div id="stockdetails" class="col-md-6">
          <div class="row">
            <p class="col-md-3 col-xs-6"><b>Stock Details</b></p>
            <div class="col-md-6 hidden-xs"></div>
            <div class="col-md-3 col-xs-6">
              <button type="button" ng-disabled="Symbol_=='' || Symbol_==undefinded" ng-click="starshow()" class="btn btn-default">
                <span ng-class="star" ng-style="{'color':starcolor}" aria-hidden="true" ></span></button>
              &nbsp
              <button type="button" ng-disabled="Symbol_=='' || Symbol_==undefinded" ng-click="fbshare()"  class="btn btn-default"><img src="http://cs-server.usc.edu:45678/hw/hw8/images/facebook.png" height="20"></button>
            </div>
           </div>
        <div>
          <div ng-show="char1==0">
           <div  class="progress">
             <div class="progress-bar progress-bar-striped active" role="progressbar" 
                  aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
               <span class="sr-only">45% Complete</span>
             </div> 
           </div>
          </div>
          <div ng-if="char1==1">
         
          <div ng-show="pricesecceed==0 || interdaysecceed==0" class="alert alert-danger" role="alert">Error! Failed to get Current Stock data.</div>
          <div ng-show="pricesecceed==1 && interdaysecceed==1"  id="showtable" >
          <table class='table table-striped'>
          <tr><td><b>Stock Ticker Symbol</b></td><td>{{Symbol_}}</td></tr>
          <tr><td><b>Last Price</b></td><td>{{Close}}</td></tr>
          <tr><td><b>Change(Change Percent)</b></td><td ng-style="{'color':changecolor}">{{Change}}&nbsp({{ChaPrecent}})<img ng-src={{Arrow}} height='14'/></td></tr>
          <tr><td><b>Timestamp</b></td><td>{{Timestamp}}</td></tr>
          <tr><td><b>Open</b></td><td>{{Open}}</td></tr>
          <tr><td><b>Previous Close</b></td><td>{{PreClose}}</td></tr>
          <tr><td><b>Day's Range</b></td><td>{{DayRange}}</td></tr>
          <tr><td><b>Volume</b></td><td>{{chanVo}}</td></tr>
          </table>
         </div>
         </div>
       </div>
</div>
         <div id="showchart" class="col-md-6">
  <uib-tabset active="active">
    <uib-tab index="0" heading="Price">
      <div ng-if="char1==1 || pricesecceed==0">
        <div ng-show="pricesecceed==0">
          <br>
          <div  class="alert alert-danger" role="alert">Error! Failed to get Price data.</div>
        </div>
      
       <div ng-if="pricesecceed==1" style="width: 100%">
          <highchart   id="chart1" config="chartConfig['Price']" ></highchart>
       </div>
      
       </div>
       <div ng-show="char1==0 && pricesecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="1" heading="SMA">
       <div ng-if="char1==1 || SMAsecceed==0">
      <div ng-show="SMAsecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get SMA data.</div>
      <div ng-if="SMAsecceed==1" style="width: 100%">
        <highchart  id="chart2" config="chartConfig['SMA']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && SMAsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="2" heading="EMA">
       <div ng-if="char1==1 || EMAsecceed==0">
      <div ng-show="EMAsecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get EMA data.</div>
      <div style="width: 100%" ng-if="EMAsecceed==1">
        <highchart  id="chart3" config="chartConfig['EMA']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && EMAsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="3" heading="STOCH">
       <div ng-if="char1==1 || STOCHsecceed==0">
      <div ng-show="STOCHsecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get STOCH data.</div>
      <div ng-if="STOCHsecceed==1" style="width: 100%">
        <highchart  id="chart4" config="chartConfig['STOCH']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && STOCHsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="4" heading="RSI">
      <div ng-if="char1==1 || RSIsecceed==0">
      <div ng-show="RSIsecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get RSI data.</div>
      <div style="width: 100%" ng-if="RSIsecceed==1">
        <highchart  id="chart5" config="chartConfig['RSI']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && RSIsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="5" heading="ADX">
       <div ng-if="char1==1 || ADXsecceed==0">
      <div ng-show="ADXsecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get ADX data.</div>
      <div style="width: 100%" ng-if="ADXsecceed==1">
        <highchart  id="chart6" config="chartConfig['ADX']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && ADXsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="6" heading="CCI">
       <div ng-if="char1==1 || CCIsecceed==0">
      <div ng-show="CCIsecceed==0" class="alert alert-danger" role="alert">Error! Failed to get CCI data.</div>
      <div style="width: 100%"  ng-if="CCIsecceed==1">
        <highchart  id="chart7" config="chartConfig['CCI']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && CCIsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="7" heading="BBANDS">
      <div ng-if="char1==1 || BBANDSsecceed==0">
      <div ng-show="BBANDSsecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get BBANDS data.</div>
      <div style="width: 100%" ng-if="BBANDSsecceed==1">
        <highchart  id="chart8" config="chartConfig['BBANDS']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && BBANDSsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
    <uib-tab index="8" heading="MACD">
      <div ng-if="char1==1 || MACDsecceed==0">
      <div ng-show="MACDsecceed==0" class="alert alert-danger" role="alert">Error! Failed to get MACD data.</div>
      <div style="width: 100%"  ng-if="MACDsecceed==1">
        <highchart  id="chart9" config="chartConfig['MACD']" ></highchart>
      </div>
       
       </div>
       <div ng-show="char1==0 && MACDsecceed==1">
        <br>
        <br>
          <div  class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" 
             aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
             <span class="sr-only">45% Complete</span>
            </div>
          </div>
        </div>
    </uib-tab>
  </uib-tabset>
</div>
        </div>


      <div ng-show="choose==2" id="Historical_chart">
        <div ng-show="char1==0">
            <br />
            <br />
           <div  class="progress">
             <div class="progress-bar progress-bar-striped active" role="progressbar" 
                  aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
               <span class="sr-only">45% Complete</span>
             </div> 
           </div>
          </div>
          <div ng-if="char1==1">
           <div ng-show="interdaysecceed==0"  class="alert alert-danger" role="alert">Error! Failed to get historical charts data.</div>
           <div style="width: 100%" ng-if="interdaysecceed==1">
              <highchart  id="chart10" config="stockConfig" ></highchart>
           </div>
           
        </div>
      </div>


      <div ng-show="choose==3" id="news">
        <div ng-show="char1==0">
            <br />
            <br />
           <div  class="progress">
             <div class="progress-bar progress-bar-striped active" role="progressbar" 
                  aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
               <span class="sr-only">45% Complete</span>
             </div> 
           </div>
          </div>
          <div ng-if="char1==1">
           <div ng-show="newsecceed==0" class="alert alert-danger" role="alert">Error! Failed to get news data.</div>
            <div ng-show="newsecceed==1" ng-repeat="art in articlenews">
            <div class="well">
              <h4 class="text-left"><a href="{{art.link}}" target="_blank">{{art.title}}</a></h4>
              <br />
              <br />
              <p class="text-left"><b>Author: {{art.author}}</b></p>
              <p class="text-left"><b>Date: {{art.pubDate}}</b></p>
            </div>          
        </div>
        </div>
       
      </div>
    </div><!-- table container -->


    </div> <!-- panel -->

</div>

  </body>
</html>
